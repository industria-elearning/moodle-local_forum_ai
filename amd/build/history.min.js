define("local_forum_ai/history",["exports","core/modal_factory","core/ajax","core/notification","core/str","./utils/renderPost"],(function(_exports,_modal_factory,_ajax,_notification,_str,_renderPost){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modal_factory=_interopRequireDefault(_modal_factory),_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification);async function renderDiscussion(data,strings){let html="<h4>".concat(data.course," / ").concat(data.forum,"</h4>\n                <h5>").concat(strings.discussionLabel,"</h5>");if(0===data.posts.length)html+='<p class="text-warning">'.concat(strings.noPosts,"</p>");else for(const post of data.posts)html+=await(0,_renderPost.renderPost)(post);let statusClass="bg-secondary",statusLabel='<i class="fa fa-robot mr-2"></i> '.concat(strings.aiResponse);return"approved"===data.status?(statusClass="bg-success text-white",statusLabel='<i class="fa fa-check mr-2"></i> '.concat(strings.aiResponseApproved)):"rejected"===data.status&&(statusClass="bg-danger text-white",statusLabel='<i class="fa fa-times mr-2"></i> '.concat(strings.aiResponseRejected)),html+='<div class="alert mt-4 '.concat(statusClass,'">\n                <h5>').concat(statusLabel,"</h5>\n                ").concat(data.airesponse,"\n             </div>"),html}_exports.init=()=>{document.querySelectorAll(".view-details").forEach((btn=>{btn.addEventListener("click",(e=>{const token=e.currentTarget.dataset.token;_ajax.default.call([{methodname:"local_forum_ai_get_details",args:{token:token}}])[0].done((async data=>{const[modalTitle,discussionLabel,noPosts,aiResponse,aiResponseApproved,aiResponseRejected]=await Promise.all([(0,_str.get_string)("modal_title","local_forum_ai"),(0,_str.get_string)("discussion_label","local_forum_ai",data.discussion),(0,_str.get_string)("no_posts","local_forum_ai"),(0,_str.get_string)("ai_response","local_forum_ai"),(0,_str.get_string)("ai_response_approved","local_forum_ai"),(0,_str.get_string)("ai_response_rejected","local_forum_ai")]);_modal_factory.default.create({type:_modal_factory.default.types.DEFAULT,title:modalTitle,body:renderDiscussion(data,{discussionLabel:discussionLabel,noPosts:noPosts,aiResponse:aiResponse,aiResponseApproved:aiResponseApproved,aiResponseRejected:aiResponseRejected}),large:!0}).done((modal=>{modal.show()}))})).fail(_notification.default.exception)}))}))}}));

//# sourceMappingURL=history.min.js.map