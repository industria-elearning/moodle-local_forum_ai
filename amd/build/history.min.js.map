{"version":3,"file":"history.min.js","sources":["../src/history.js"],"sourcesContent":["import ModalFactory from 'core/modal_factory';\nimport Ajax from 'core/ajax';\nimport Notification from 'core/notification';\nimport { renderPost } from './utils/renderPost';\n\n/**\n * Inicializa los listeners para mostrar historial de respuestas AI.\n */\nexport const init = () => {\n    document.querySelectorAll('.view-details').forEach(btn => {\n        btn.addEventListener('click', e => {\n            const token = e.currentTarget.dataset.token;\n\n            Ajax.call([{\n                methodname: 'local_forum_ai_get_details',\n                args: { token: token },\n            }])[0].done(data => {\n                ModalFactory.create({\n                    type: ModalFactory.types.DEFAULT,\n                    title: 'Detalles del historial de debate',\n                    body: renderDiscussion(data),\n                    large: true,\n                }).done(modal => {\n                    modal.show();\n                });\n            }).fail(Notification.exception);\n        });\n    });\n};\n\n/**\n * Construye el HTML para el modal de historial.\n *\n * @param {Object} data Datos recibidos del servicio AJAX\n * @returns {string} HTML\n */\nfunction renderDiscussion(data) {\n    let html = `<h4>${data.course} / ${data.forum}</h4>\n                <h5>Debate: ${data.discussion}</h5>`;\n\n    if (data.posts.length === 0) {\n        html += '<p class=\"text-warning\">No se encontraron posts en este debate.</p>';\n    } else {\n        data.posts.forEach(post => {\n            html += renderPost(post);\n        });\n    }\n\n    // ðŸŽ¨ Fondo segÃºn estado\n    let statusClass = 'bg-secondary';\n    let statusLabel = '<i class=\"fa fa-robot mr-2\"></i> Respuesta AI';\n    if (data.status === 'approved') {\n        statusClass = 'bg-success text-white';\n        statusLabel = '<i class=\"fa-solid fa-robot\"></i> Respuesta AI (Aprobada)';\n    } else if (data.status === 'rejected') {\n        statusClass = 'bg-danger text-white';\n        statusLabel = '<i class=\"fa fa-times mr-2\"></i> Respuesta AI (Rechazada)';\n    }\n\n    html += `<div class=\"alert mt-4 ${statusClass}\">\n                <h5>${statusLabel}</h5>\n                ${data.airesponse}\n             </div>`;\n\n    return html;\n}\n"],"names":["renderDiscussion","data","html","course","forum","discussion","posts","length","forEach","post","statusClass","statusLabel","status","airesponse","document","querySelectorAll","btn","addEventListener","e","token","currentTarget","dataset","call","methodname","args","done","create","type","ModalFactory","types","DEFAULT","title","body","large","modal","show","fail","Notification","exception"],"mappings":"+eAoCSA,iBAAiBC,UAClBC,mBAAcD,KAAKE,qBAAYF,KAAKG,oDACdH,KAAKI,oBAEL,IAAtBJ,KAAKK,MAAMC,OACXL,MAAQ,sEAERD,KAAKK,MAAME,SAAQC,OACfP,OAAQ,0BAAWO,aAKvBC,YAAc,eACdC,YAAc,sDACE,aAAhBV,KAAKW,QACLF,YAAc,wBACdC,YAAc,6DACS,aAAhBV,KAAKW,SACZF,YAAc,uBACdC,YAAc,6DAGlBT,uCAAkCQ,+CAChBC,8CACJV,KAAKY,oCAGZX,mBAxDS,KAChBY,SAASC,iBAAiB,iBAAiBP,SAAQQ,MAC/CA,IAAIC,iBAAiB,SAASC,UACpBC,MAAQD,EAAEE,cAAcC,QAAQF,oBAEjCG,KAAK,CAAC,CACPC,WAAY,6BACZC,KAAM,CAAEL,MAAOA,UACf,GAAGM,MAAKxB,8BACKyB,OAAO,CAChBC,KAAMC,uBAAaC,MAAMC,QACzBC,MAAO,mCACPC,KAAMhC,iBAAiBC,MACvBgC,OAAO,IACRR,MAAKS,QACJA,MAAMC,aAEXC,KAAKC,sBAAaC"}