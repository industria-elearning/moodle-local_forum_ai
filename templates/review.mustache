{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template local_forum_ai

    TODO describe template forum_ai

    Example context (json):
    {
    }
}}

<div class="alert alert-info">
  <h5><i class="icon fa fa-info-circle"></i> Información del debate</h5>
  <p><strong>Curso:</strong> {{course}}</p>
  <p><strong>Foro:</strong> {{forum}}</p>
  <p><strong>Debate:</strong> {{discussion}}</p>
  <p><strong>Creado:</strong> {{timecreated}}</p>
</div>

<div class="row">
  <div class="col-md-6">
    <div class="card mb-3">
      <div class="card-header"><h5><i class="fa fa-comment"></i> Mensaje original</h5></div>
      <div class="card-body">
        <h6>{{originalsubject}}</h6>
        {{{originalmessage}}}
        <br>
        <small class="text-muted">Por: {{author}} el {{originaldate}}</small>
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <div class="card mb-3">
      <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
        <h5 class="mb-0"><i class="fa fa-robot"></i> Respuesta AI propuesta</h5>
        <button id="edit-btn" class="btn btn-sm btn-light"><i class="fa fa-pencil"></i></button>
      </div>
      <div class="card-body">

        <!-- Vista normal -->
        <div id="airesponse-view" data-discussionid="{{discussionid}}">
          <h6>{{aisubject}}</h6>
          <div class="card-text">{{{aimessage}}}</div>
          <small class="text-muted">Respuesta AI generada</small>
        </div>

        <!-- Vista edición -->
        <form id="airesponse-edit" method="post" data-token="{{token}}" style="display:none;">
          <textarea name="message" class="form-control" rows="6">{{aiformatted}}</textarea>
          <button type="submit" class="btn btn-success btn-sm mt-2">
            <i class="fa fa-save"></i> Guardar
          </button>
          <button type="button" id="cancel-edit" class="btn btn-secondary btn-sm mt-2">Cancelar</button>
        </form>

      </div>
    </div>
  </div>
</div>

<!-- Botones aprobar/rechazar -->
<div class="row mt-4">
  <div class="col text-center">
    <button class="btn btn-success btn-lg action-btn" data-action="approve" data-token="{{token}}" data-discussionid="{{discussionid}}">
      <i class="fa fa-check"></i> Aprobar
    </button>
    <button class="btn btn-danger btn-lg ml-2 action-btn" data-action="reject" data-token="{{token}}" data-discussionid="{{discussionid}}">
      <i class="fa fa-times"></i> Rechazar
    </button>
  </div>
</div>

<!-- Botón volver -->
<div class="row mt-3">
  <div class="col text-center">
    <a href="{{forumurl}}" class="btn btn-secondary">
      <i class="fa fa-arrow-left"></i> Volver al debate
    </a>
  </div>
</div>
